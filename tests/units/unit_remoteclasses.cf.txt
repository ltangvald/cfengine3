***********************************************************
 Promises 
***********************************************************
Bundle g in the context of common

   ARGS:

   {
   TYPE: vars

      vars promise by 'signal' (implicit) if context is any

             string => pack_a_name       if body context any
            Promise (version 1.2.3) belongs to bundle 'g' (type common) in file '../tests/units/unit_remoteclasses.cf' near line 33


   }


Bundle job_chain in the context of agent

   ARGS:

   scalar arg time

   {
   TYPE: vars

      vars promise by 'client' (implicit) if context is any

             string => localhost       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 44


      vars promise by 'server' (implicit) if context is any

             string => localhost       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 45


      vars promise by 'margin' (implicit) if context is any

             string => 5       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 46


   TYPE: classes

      classes promise by 'client_primed' (implicit) if context is any

         expression => classmatch(canonify($(client),))         ifvarclass => $(time)       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 50


      classes promise by 'server_primed' (implicit) if context is any

         expression => classmatch(canonify($(server),))         ifvarclass => $(time)       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 53


      classes promise by 'succeeded' (implicit) if context is client_primed

         expression => remoteclassesmatching($(g.signal),$(server),no,myprefix,)            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 58


   TYPE: methods

      methods promise by 'downstream' (implicit) if context is client_primed.myprefix_job_finished

          usebundle => do_job(Starting local follow-up job,)             action => if_elapsed body for type action
               arg x

               {
               ifelapsed => $(x) if sub-body context any
               }
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 68


      methods promise by 'upstream' (implicit) if context is server_primed

          usebundle => do_job(Starting remote job,)             action => if_elapsed body for type action
               arg x

               {
               ifelapsed => $(x) if sub-body context any
               }
            classes => signal_repaired body for type classes
               arg x

               {
               promise_repaired =>  {'$(x)'} if sub-body context any
               persist_time => 10 if sub-body context any
               }
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 73


   TYPE: reports

      reports promise by 'Server communication failed' (implicit) if context is !succeeded

         ifvarclass => $(time)       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 81


      reports promise by 'Job completed on the server...' (implicit) if context is !succeeded

         ifvarclass => $(g.signal)       if body context any
            Promise (version 1.2.3) belongs to bundle 'job_chain' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 86


   }


Bundle do_job in the context of agent

   ARGS:

   scalar arg job

   {
   TYPE: commands

      commands promise by '/bin/echo $(job)' (implicit) if context is any

            Promise (version 1.2.3) belongs to bundle 'do_job' (type agent) in file '../tests/units/unit_remoteclasses.cf' near line 100


   }


Bundle access_rules in the context of server

   ARGS:

   {
   TYPE: vars

      vars promise by 'localvar' (implicit) if context is any

             string => literal string       if body context any
            Promise (version 1.2.3) belongs to bundle 'access_rules' (type server) in file '../tests/units/unit_remoteclasses.cf' near line 124


   TYPE: access

      access promise by '$(g.signal)' (implicit) if context is any

             handle => test_class_signal       if body context any
         resource_type => context       if body context any
              admit =>  {'127.0.0.1'}       if body context any
            Promise (version 1.2.3) belongs to bundle 'access_rules' (type server) in file '../tests/units/unit_remoteclasses.cf' near line 130


   }




All Bodies

control body for type common(no parameters)
   {
   bundlesequence =>  {'job_chain(Hr14,)'} if sub-body context any
   version => 1.2.3 if sub-body context any
   }

control body for type server(no parameters)
   {
   allowconnects =>  {'127.0.0.1','::1'} if sub-body context any
   allowallconnects =>  {'127.0.0.1','::1'} if sub-body context any
   trustkeysfrom =>  {'127.0.0.1','::1'} if sub-body context any
   allowusers =>  {'mark'} if sub-body context any
   }

if_elapsed body for type action
   arg x

   {
   ifelapsed => $(x) if sub-body context any
   }

signal_repaired body for type classes
   arg x

   {
   promise_repaired =>  {'$(x)'} if sub-body context any
   persist_time => 10 if sub-body context any
   }

