#######################################################
#
# GetIndices from an array into a list
#
#######################################################

body common control

{
any::

  bundlesequence  => {
                     test
                     };   
}

#######################################################

bundle agent test

{
vars:

  "ps[relayhost]"                  string => "[$(mailrelay)]:587";
  "ps[mydomain]"                   string => "iu.hio.no";
  "ps[smtp_sasl_auth_enable]"      string => "yes";
  "ps[smtp_sasl_password_maps]"    string => "hash:/etc/postfix/sasl-passwd";
  "ps[smtp_sasl_security_options]" string => "";
  "ps[smtp_use_tls]"               string => "yes";
  "ps[default_privs]"              string => "mailman";
  "ps[inet_protocols]"             string => "all";
  "ps[inet_interfaces]"            string => "127.0.0.1";

  "parameter_name" slist => getindices("ps");

reports:

 linux::

  "Found key $(parameter_name)";

}
